const char _script[] PROGMEM = R"=====(
const HOST_URL=window.location.origin,uriList={speed:"sb",bright:"sb",settings:"setting",creds:"creds",pixels:"pixels",pixelUpdate:"pixelupdate"};var Socket,historyPos=[],historyData=[],runtime={status:{row:8,col:16},rename:{status:!1,id:"",text:""},pixel:{posX:-1,posY:-1,state:[],rmousedn:!1,lmousedn:!1,click:!1,erase:!1,leftS:[],rightS:[],ln:16}};function dq(a){return document.querySelectorAll(a)}function d(a){return document.getElementById(a)}function dt(a){return document.getElementsByTagName(a)}function dae(a,b,c){a.addEventListener(b,c)}function dar(a,b,c){a.removeEventListener(b,c)}function dc(a){return document.getElementsByClassName(a)}function dca(a){return document.getElementsByClassName(a)}function dnone(a){a.style.display="none"}function dflex(a){a.style.display="flex"}function dchange(a,b,c){a.classList.replace(b,c)}const er=a=>{console.log(a)},_send=(a,b)=>{er(a+b),Socket.send(a+b)},disEn=(a,b)=>{a.disabled=b},connect=()=>{Socket=new WebSocket("ws://"+window.location.hostname+":81/");var a=d("connection");Socket.onmessage=a=>{er(a.data)},Socket.onopen=()=>{er("Socket connected.")},Socket.onclose=a=>{er("Socket is closed. Reattempting.."),setTimeout(function(){connect()},250)},Socket.onerror=a=>{Socket.close()}},fPOST=(a,b,c)=>{bodyArg="",b.forEach(a=>{bodyArg+=`${a.param}=${a.value}&`}),bodyArg=bodyArg.substring(0,bodyArg.length-1),fetch(`${HOST_URL}/${a}`,{method:"POST",headers:{"Content-type":"application/x-www-form-urlencoded"},body:bodyArg}).then(a=>a.text()).then(c)},fGET=(a,b,c)=>{bodyArg="",b.forEach(a=>{bodyArg+=`${a.param}=${a.value}&`}),fetch(`${HOST_URL}/${a}${bodyArg="?"+bodyArg.substring(0,bodyArg.length-1)}`).then(a=>a.text()).then(c)},clearLedFn=()=>{Array.prototype.forEach.call(dq("input[type=radio][name=LedDisplay]"),a=>{a.checked=!1})},displayScreen=c=>{let a={controls:{id:["CONTROLS","MAIN_TEXTBOX"],cl:["dfrfs","dfrfs"]},history:{id:["HISTORY","MAIN_TEXTBOX"],cl:["dfrfs","dfrfs"]},settings:{id:["SETTINGS","MAIN_TEXTBOX"],cl:["dfrfs","dfrfs"]},pixelart:{id:["PIXELART","PIXEL_CONTROLS"],cl:["dfcfs","dfrse"]}};for(let e in a)a[e].id.forEach((b,c)=>dchange(d(`ID_${b}`),a[e].cl[c],"dn"));for(let b in a)a[b].id[0]==c&&a[b].id.forEach((c,e)=>{dchange(d(`ID_${c}`),"dn",a[b].cl[e])})},drawPixelBoard=(m,b)=>{let c=d("ID_PIXEL_BOARD"),k=c.offsetWidth,l=c.offsetHeight;var e=k<l?k:l,n=k<l?b:m;if(e=e/n*.6,c.innerHTML="",0===runtime.pixel.state.length)for(var a=0;a<b;a++)runtime.pixel.state[a]=0;for(var a=0;a<m;a++){let f=document.createElement("div");f.setAttribute("class","dfrfs  pixelart-row"),f.setAttribute("ID",`pir${a}`),c.appendChild(f);for(var g=0;g<b;g++){let h=document.createElement("div");h.setAttribute("class","dfrse pixelart-col");let i=a*b+g;h.setAttribute("ID",`pic${i}`),f.appendChild(h);let j=document.createElement("div");runtime.pixel.state[g]>>a&1?j.setAttribute("class","dfrfs pixel-dot-ch"):j.setAttribute("class","dfrfs pixel-dot"),j.setAttribute("ID",`dot${i}`),h.appendChild(j),d(`dot${i}`).style.width=e+"px",d(`dot${i}`).style.height=e+"px"}}},pixelDisplayInit=()=>{drawPixelBoard(8,16)};Array.prototype.forEach.call(dq("input[type=radio][name=navbar]"),a=>{dae(a,"change",b=>{var a=b.target.value;displayScreen(a.substring(a.lastIndexOf("_")+1)),d("navham").checked=!1}),a.checked&&(displayScreen(a.value.substring(a.value.lastIndexOf("_")+1)),"PIXEL_ART_RADIO"==a.id&&(pixelDisplayInit(),clearLedFn()))});const colorPixelDisplay=(b,j,g)=>{if(!(runtime.pixel.lmousedn||runtime.pixel.rmousedn))return;let h=d("ID_PIXEL_BOARD"),i=h.offsetWidth,k=h.offsetHeight,l=window.innerWidth;var m=i/g,n=k/j,o=(l-i)/2;let p=d("ID_TOP_BAR").offsetHeight,q=d("ID_CENTER_WRAPPER").offsetHeight;var r=p+q,a=parseInt((b.clientX-o)/m),e=parseInt((b.clientY-r)/n);let s=g*e+a,f=d(`dot${s}`),c=f.getBoundingClientRect();if(b.clientX>=c.x&&b.clientX<=c.x+c.width&&b.clientY>=c.y&&b.clientY<=c.y+c.height){if(runtime.pixel.posX==a&&runtime.pixel.posY==e)return;runtime.pixel.posX=a,runtime.pixel.posY=e,runtime.pixel.lmousedn?(dchange(f,"pixel-dot","pixel-dot-ch"),runtime.pixel.state[a]|=1<<e):runtime.pixel.rmousedn&&(dchange(f,"pixel-dot-ch","pixel-dot"),runtime.pixel.state[a]&=~(1<<e)),_send("p",`${a},${runtime.pixel.state[a]}`)}else runtime.pixel.posX=-1,runtime.pixel.posY=-1},colorPixels=a=>colorPixelDisplay(a,8,16),validateNumber=a=>!(!a.match(/^([0-9]?[0-9]?\d)$/)||parseInt(a)>100);dae(d("ID_SPEED"),"input",a=>{d("ID_SPEED_VAL").value=a.target.value}),dae(d("ID_SPEED_VAL"),"input",b=>{var a=b.target.value;if(validateNumber(a)){d("ID_SPEED").value=a;return}d("ID_SPEED").value=0,d("ID_SPEED_VAL").value=""}),dae(d("ID_BRIGHT"),"input",a=>{d("ID_BRIGHT_VAL").value=a.target.value}),dae(d("ID_BRIGHT_VAL"),"input",b=>{var a=b.target.value;if(validateNumber(a)){d("ID_BRIGHT").value=a;return}d("ID_BRIGHT").value=0,d("ID_BRIGHT_VAL").value=""});const limitTextSize=a=>a.length>20?a.substring(0,20)+"...":a,pushHistory=(c,a)=>{let e=d("ID_HISTORY_TEXT"),b=a[0],f="t"==b?c:`PixelSave${a.substring(1)}`;e.innerHTML+=`<div class="dfrse history-row" id="hc${a}">
                                <div class="dfrse text history-text-row" id="hh${a}" onclick="sendText(this)">${limitTextSize(f)}</div>
                                <div class="dfrse history-btn-cont">
                                    <div class="dfrse text history-btn ${"p"==b?"dn":""}" id="hr${a}" onclick="rnTextbox(this)">Rename</div>
                                    <div class="dfrse text history-btn" id="hd${a}" onclick="deleteText(this)">Delete</div>
                                </div>
                          </div>`},getHistoryText=b=>{for(var a=0;a<historyData.length;a++)if(historyData[a].p==b)return historyData[a].t;return""},updateHistoryText=(b,c)=>{for(var a=0;a<historyData.length;a++)if(historyData[a].p==b){historyData[a].t=c;return}},rnTextbox=g=>{let c=g.id.substring(2),h=d(`hc${c}`),i=d(`hh${c}`),f=d(`hr${c}`),a=document.createElement("div");if(a.setAttribute("id",`hh${c}`),"Rename"===f.innerHTML){runtime.rename.status&&rnTextbox(runtime.rename);let e=getHistoryText(c);runtime.rename.status=!0,runtime.rename.id=g.id,runtime.rename.text=e,a.setAttribute("class","dfrse history-textbox-cont");let b=document.createElement("input");b.setAttribute("type","text"),b.setAttribute("class","history-textbox text"),b.setAttribute("value",e),b.setAttribute("id",`ht${c}`),a.appendChild(b),h.replaceChild(a,i),f.innerHTML="Cancel",b.focus(),b.setSelectionRange(e.length,e.length,"forward"),runtime.rename.status=!0,dae(b,"keypress",sendRnText);return}a.setAttribute("class","dfrse text history-text-row"),a.setAttribute("onclick","sendText(this)"),a.innerHTML=limitTextSize(runtime.rename.text),dar(d(`ht${c}`),"keypress",sendRnText),runtime.rename.status=!1,h.replaceChild(a,i),f.innerHTML="Rename"},sendRnText=a=>{if("Enter"==a.key&&""!=a.target.value){if(a.target.value===runtime.rename.text){rnTextbox(a.target);return}let b=a.target.id.substring(2),c=a.target.value.trim();fPOST("rename",[{param:"ind",value:b},{param:"data",value:c}],()=>{runtime.rename.text=c,updateHistoryText(b,c),rnTextbox(a.target)})}},deleteText=a=>{fGET("delete",[{param:"ind",value:a.id.substring(2)}],()=>{let b=d("ID_HISTORY_TEXT");b.removeChild(d(`hc${a.id.substring(2)}`))})},sendText=a=>{fGET("disp",[{param:"ind",value:a.id.substring(2)}],()=>{})},updateWMODE=b=>{let c=["ID_S_WMODE_STA","ID_S_WMODE_AP"],a=getComputedStyle(document.body),f=a.getPropertyValue("--settingsRowBg"),e=a.getPropertyValue("--settingsBtnHover");c.forEach(a=>{d(a).style.backgroundColor=f}),d(`ID_S_WMODE_${b}`).style.backgroundColor=e},sendSettings=(a,b,c)=>{fGET(uriList.settings,[{param:"type",value:a},{param:"val",value:b}],c)},clearCredsText=a=>{let b=a+"_SSID",c=a+"_PASS";d(b).value="",d(c).value=""},validateCred=(b,a)=>!!(b.match(/^[^!#;+\]\/"\t][^+\]"\t]{0,31}$/)&&""!=a&&a.match(/^[ -~]{8,63}$/)),sendCreds=b=>{let a=b.substring(0,b.lastIndexOf("_")),f=a+"_SSID",g=a+"_PASS",c=d(f).value,e=d(g).value;if(!validateCred(c,e)){clearCredsText(a);return}let h=a.substring(a.lastIndexOf("_")+1);fPOST(uriList.creds,[{param:"type",value:h},{param:"ssid",value:c},{param:"pass",value:e}],clearCredsText(a))},settingsList=[{id:"ID_S_WMODE_STA",e:"click",fun(){sendSettings("WMODE",0,()=>{updateWMODE("STA")})}},{id:"ID_S_WMODE_AP",e:"click",fun(){sendSettings("WMODE",1,()=>{updateWMODE("AP")})}},{id:"ID_S_CREDS_STA_SUBMIT",e:"click",fun(){sendCreds("ID_S_CREDS_STA_SUBMIT")}},{id:"ID_S_CREDS_AP_SUBMIT",e:"click",fun(){sendCreds("ID_S_CREDS_AP_SUBMIT")}},{id:"ID_S_RESTART",e:"click",fun(){sendSettings("RESET",0,()=>{})}},{id:"ID_S_RELOAD",e:"click",fun(){sendSettings("RESET",1,()=>{})}},{id:"ID_S_FRESET",e:"click",fun(){sendSettings("RESET",2,()=>{})}},{id:"PIXEL_ART_RADIO",e:"change",fun(){clearLedFn(),pixelDisplayInit(),sendSettings("anim","pixel",()=>{})}},{id:"ID_SPEED",e:"change",fun(a){sendSettings("speed",a.target.value,()=>{})}},{id:"ID_SPEED_VAL",e:"change",fun(a){sendSettings("speed",a.target.value,()=>{})}},{id:"ID_BRIGHT",e:"change",fun(a){sendSettings("bright",a.target.value,()=>{})}},{id:"ID_BRIGHT_VAL",e:"change",fun(a){sendSettings("bright",a.target.value,()=>{})}}],pixToHex=a=>a<=15?`0${a.toString(16)}`:a.toString(16),clearDisplay=()=>{runtime.pixel.state=[],runtime.pixel.leftS=[],runtime.pixel.rightS=[],pixelDisplayInit()},pixelClear=()=>{clearDisplay(),_send("c","")},pixErase=()=>{runtime.pixel.erase=!runtime.pixel.erase},pixInvert=()=>{runtime.pixel.state=runtime.pixel.state.map(a=>255-a),pixelDisplayInit(),_send("i","")},pixLeft=()=>{let b=runtime.pixel.ln,c=runtime.pixel.state[0];runtime.pixel.leftS.push(c||0);for(var a=0;a<b-1;a++)runtime.pixel.state[a]=runtime.pixel.state[a+1];let e=runtime.pixel.rightS.pop()||0;runtime.pixel.state[b-1]=e,pixelDisplayInit(),_send("l","")},pixRight=()=>{let b=runtime.pixel.ln,c=runtime.pixel.state[b-1];runtime.pixel.rightS.push(c||0);for(var a=b-1;a>0;a--)runtime.pixel.state[a]=runtime.pixel.state[a-1];let e=runtime.pixel.leftS.pop()||0;runtime.pixel.state[0]=e,pixelDisplayInit(),_send("r","")},pixelSave=()=>{clearDisplay(),_send("s",""),appendHistory("p","")},PIXEL_EVENTS=[{id:"ID_PIXEL_CLEAR",e:"click",fun:pixelClear},{id:"ID_PIXEL_ERASE",e:"click",fun:pixErase},{id:"ID_PIXEL_INVERT",e:"click",fun:pixInvert},{id:"ID_PIXEL_LEFT",e:"click",fun:pixLeft},{id:"ID_PIXEL_RIGHT",e:"click",fun:pixRight},{id:"ID_PIXEL_SAVE",e:"click",fun:pixelSave}],maxHPos=()=>{if(0==historyPos.length)return 0;var a=parseInt(historyPos[0].substring(1));return historyPos.forEach(c=>{let b=parseInt(c.substring(1));b>a&&(a=b)}),a},appendHistory=(c,b)=>{let a=`${c}${maxHPos()+1}`;historyData.push({p:a,t:b}),pushHistory(b,a),historyPos.push(a)},pixelInput=(a,c)=>{a=a||window.event,runtime.pixel.posX=-1,runtime.pixel.posY=-1;var b=a.which;switch(b=runtime.pixel.erase?1==b?3:1:b){case 1:runtime.pixel.lmousedn=c,colorPixels(a);break;case 3:runtime.pixel.rmousedn=c,colorPixels(a)}};dae(document,"DOMContentLoaded",()=>{fetch(`${HOST_URL}/status`).then(a=>a.text()).then(a=>{a=JSON.parse(a),d("ID_SPEED").value=a.S,d("ID_SPEED_VAL").value=a.S,d("ID_BRIGHT").value=a.B,d("ID_BRIGHT_VAL").value=a.B,runtime.status.row=a.R,runtime.status.col=a.C,er(a)}),fetch(`${HOST_URL}/history`).then(a=>a.text()).then(a=>{"[]"!=a&&(er(a),a=a.substring(0,a.length-2)+"]",(a=JSON.parse(a)).forEach(a=>{historyData.push(a),pushHistory(a.t,a.p),historyPos.push(a.p)}))}),fetch(`${HOST_URL}/${uriList.pixels}`).then(a=>a.text()).then(a=>{"[]"!=a&&(er(a),a=JSON.parse(a),runtime.pixel.leftS=a[0],runtime.pixel.state=a[1],runtime.pixel.rightS=a[2],pixelDisplayInit())}),connect(),dae(window,"resize",()=>{d("PIXEL_ART_RADIO").checked&&pixelDisplayInit()}),dae(d("ID_PIXEL_BOARD"),"mousedown",a=>{pixelInput(a,!0)}),dae(window,"mouseup",a=>{pixelInput(a,!1)}),dae(d("ID_PIXEL_BOARD"),"touchstart",a=>{let b={which:1,clientX:a.touches[0].clientX,clientY:a.touches[0].clientY};pixelInput(b,!0)}),dae(d("ID_PIXEL_BOARD"),"touchend",a=>{let b={which:1,clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY};pixelInput(b,!1)}),dae(d("ID_PIXEL_BOARD"),"touchmove",a=>{let b={clientX:a.touches[0].clientX,clientY:a.touches[0].clientY};colorPixels(b)}),dae(d("ID_PIXEL_BOARD"),"mousemove",colorPixels),dae(d("ID_MAIN_TEXTBOX"),"keypress",a=>{"Enter"==a.key&&""!=a.target.value&&fPOST("text",[{param:"data",value:a.target.value.trim()}],()=>{appendHistory("t",a.target.value),d("ID_MAIN_TEXTBOX").value=""})}),PIXEL_EVENTS.forEach(a=>{dae(d(a.id),a.e,a.fun)}),settingsList.forEach(a=>{dae(d(a.id),a.e,a.fun)}),Array.prototype.forEach.call(dq("input[type=radio][name=LedDisplay]"),a=>{dae(a,"change",a=>{var b;sendSettings("anim",a.target.value,()=>{})})})})
)=====";